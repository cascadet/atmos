# *** This file is generated by pseudoadiabat_codegen/pseudoadiabat_codegen.py ***
# *** Please ensure any updates are made in pseudoadiabat_codegen.py           ***
import numpy as np
from numba import vectorize


@vectorize(nopython=True, cache=True)
def wbpt(p, T):
    """
    Computes the wet-bulb potential temperature (WBPT) thw of the
    pseudoadiabat that passes through pressure p and temperature T.

    Uses polynomial approximations from Moisseeva and Stull (2017)
    with revised coefficients.

    Moisseeva, N. and Stull, R., 2017. A noniterative approach to
        modelling moist thermodynamics. Atmospheric Chemistry and
        Physics, 17, 15037-15043.

    Args:
        p: pressure (Pa)
        T: temperature (K)

    Returns:
        thw: wet-bulb potential temperature (K)

    """

    # Convert p to hPa and T to degC
    p_ = p / 100.
    T_ = T - 273.15

    # Check that values fall in the permitted range
    if (T_ < -100.) or (T_ > 50.) or (p_ > 1100.) or (p_ < 100.):
        # print('T or p outside limits of polynomial fit', T_, p_)
        return np.nan

    # Compute theta-w using Eq. 4-6 from Moisseeva & Stull 2017
    Tref = 5.929812754121748952e+01 + p_*(-8.012186693009129002e-01 + p_*(1.153241848787449515e-02 + p_*(-1.385692605376416260e-04 + p_*(1.123633433600090202e-06 + p_*(-6.320927123948274926e-09 + p_*(2.484905132812062063e-11 + p_*(-6.801585936048579721e-14 + p_*(1.264619936034697021e-16 + p_*(-1.466932946679048244e-19 + p_*(7.192151844856434115e-23 + p_*(5.640733604254504007e-26 + p_*(-1.011295697184182190e-28 + p_*(1.131472417582153605e-32 + p_*(8.133863408155450624e-35 + p_*(-5.131504866726228195e-38 + p_*(-4.375671997267779667e-41 + p_*(8.230244900571228374e-44 + p_*(-5.274478301794009131e-47 + p_*(1.650274385922297990e-50 + p_*(-2.118192687549920219e-54))))))))))))))))))))  # noqa: E501
    thw = 4.244386354292654318e+01 + T_*(5.743504014329349205e-01 + T_*(6.698983372921288836e-03 + T_*(3.985882876455505393e-05 + T_*(-9.518266687124513801e-07 + T_*(-7.540170754347436989e-09 + T_*(1.706583527625787248e-10 + T_*(2.279579546542021542e-12 + T_*(-3.072574527793070547e-14 + T_*(-7.416347068290732318e-16 + T_*(3.709835254324268377e-18 + T_*(2.334952012566277784e-19 + T_*(3.280556855046866962e-22 + T_*(-5.552896829641459957e-23 + T_*(-3.688906813915428773e-25 + T_*(7.515861194764863755e-27 + T_*(9.633279606717813543e-29 + T_*(-1.817753086390467778e-31 + T_*(-8.910733603066673984e-33 + T_*(-5.480152424651931605e-35 + T_*(-1.112041368340657389e-37)))))))))))))))))))) + Tref*(3.640139450053866965e-01 + T_*(1.051041267656403723e-03 + T_*(7.662535551992646519e-05 + T_*(-3.086575725914089845e-07 + T_*(-1.163983291022673667e-08 + T_*(2.752920480782767538e-11 + T_*(4.156789007815417634e-12 + T_*(1.220239677811972541e-15 + T_*(-1.333053365265130848e-15 + T_*(-5.301575982743002613e-18 + T_*(4.348878853312486094e-19 + T_*(2.152810577081369556e-21 + T_*(-1.165863623595744441e-22 + T_*(-5.649669384493748739e-25 + T_*(2.216782677015215490e-26 + T_*(1.239998208159795022e-28 + T_*(-2.589152205815317175e-30 + T_*(-2.036443646491554121e-32 + T_*(1.203071305448849461e-34 + T_*(1.642737063895474117e-36 + T_*(4.499351149337181086e-39)))))))))))))))))))) + Tref*(2.906400816767702906e-03 + T_*(6.506199526869122548e-05 + T_*(7.245987569708740913e-07 + T_*(-5.223918220684711388e-09 + T_*(-2.440558850121404309e-10 + T_*(-9.568429884848434367e-13 + T_*(2.036122588081421932e-13 + T_*(-1.547781763163764384e-16 + T_*(-1.382558180929342743e-16 + T_*(1.935079058213845341e-18 + T_*(5.466325582499714869e-20 + T_*(-1.431042206082612643e-21 + T_*(-1.705893805673445858e-23 + T_*(5.026384210758006038e-25 + T_*(5.468481907572638997e-27 + T_*(-8.508258401108153910e-29 + T_*(-1.293320915043321591e-30 + T_*(2.428272150322490305e-33 + T_*(1.281900824784794802e-34 + T_*(7.993573535371672675e-37 + T_*(1.624675525432445672e-39)))))))))))))))))))) + Tref*(6.692508639411343487e-05 + T_*(1.170840042098630066e-06 + T_*(1.618929194087415620e-08 + T_*(-1.645908494391713734e-10 + T_*(-5.446112039164349259e-12 + T_*(1.736980050027369437e-14 + T_*(5.244529042526896035e-15 + T_*(-4.341549210320637552e-17 + T_*(-2.592240468892822726e-18 + T_*(4.139936245393168031e-20 + T_*(5.192194252702767568e-22 + T_*(-1.583527611696705478e-23 + T_*(1.725447851946155860e-26 + T_*(3.449915407209161507e-27 + T_*(-2.857213875217268477e-29 + T_*(-5.603902739406984263e-31 + T_*(5.161301782552726746e-33 + T_*(7.463132477044140404e-35 + T_*(-2.349060872620592451e-37 + T_*(-5.311765169697648661e-39 + T_*(-1.651956307337915127e-41)))))))))))))))))))) + Tref*(5.646107529306188992e-07 + T_*(2.695055043524099755e-08 + T_*(3.420802530625280627e-10 + T_*(-1.557577055942485298e-11 + T_*(-7.641392313592209088e-14 + T_*(1.846739889548830932e-14 + T_*(-3.705494522902334802e-16 + T_*(-4.131770319732613231e-18 + T_*(3.609854602567907053e-19 + T_*(-5.881522271010696560e-21 + T_*(-1.544417187907607319e-22 + T_*(5.120378759505477880e-24 + T_*(5.243038233161531725e-26 + T_*(-1.884229635070376546e-27 + T_*(-1.896194549791446516e-29 + T_*(3.271309093765524913e-31 + T_*(4.794159710937475030e-33 + T_*(-9.943613314798750082e-36 + T_*(-4.878160719280809720e-37 + T_*(-3.043072185192341701e-39 + T_*(-6.215902960576140144e-42)))))))))))))))))))) + Tref*(6.510423659251241187e-09 + T_*(4.029548951185893982e-10 + T_*(7.327740574693662833e-12 + T_*(-5.529255032813864888e-13 + T_*(3.284226123056354833e-15 + T_*(6.046354752634188256e-16 + T_*(-1.722318960014019490e-17 + T_*(-7.430413151666069428e-20 + T_*(1.271685854976657926e-20 + T_*(-2.010136110681469103e-22 + T_*(-4.261242593334119593e-24 + T_*(1.455080771459861046e-25 + T_*(1.086608136531585359e-27 + T_*(-4.962778159637027124e-29 + T_*(-3.687080626281924213e-31 + T_*(8.598228216848347732e-33 + T_*(9.986825007816452816e-35 + T_*(-3.718556602790164276e-37 + T_*(-1.081723613448356121e-38 + T_*(-6.053037210845134430e-41 + T_*(-1.137308067019798126e-43)))))))))))))))))))) + Tref*(1.265434195972790215e-10 + T_*(5.701355439050157111e-12 + T_*(-1.198858925297453056e-13 + T_*(1.711310947883831930e-15 + T_*(1.151060054796753688e-16 + T_*(-7.307743250764599678e-18 + T_*(1.377015666894366053e-19 + T_*(2.039247599501932842e-21 + T_*(-1.973825335521800176e-22 + T_*(3.615924117068494080e-24 + T_*(1.036365716240548444e-25 + T_*(-3.316204524055009345e-27 + T_*(-4.057985527639396890e-29 + T_*(1.247273386044092499e-30 + T_*(1.473012999656173016e-32 + T_*(-2.132008705143049883e-34 + T_*(-3.557277741847343778e-36 + T_*(4.534188740477881252e-39 + T_*(3.480276076979110798e-40 + T_*(2.283263738244622195e-42 + T_*(4.822356513797437705e-45)))))))))))))))))))) + Tref*(2.850991484664826942e-12 + T_*(4.708507539154110243e-14 + T_*(-8.728350696267924099e-15 + T_*(4.598453400198270511e-16 + T_*(-4.743053880945186655e-19 + T_*(-6.588960083687219546e-19 + T_*(1.881838793065241799e-20 + T_*(8.296001280210227903e-23 + T_*(-1.596999617361109527e-23 + T_*(2.715956642414596391e-25 + T_*(6.261420856171718015e-27 + T_*(-2.060617903824460281e-28 + T_*(-1.954840983202525432e-30 + T_*(7.206166147171347022e-32 + T_*(6.801341205826092993e-34 + T_*(-1.228387343371150781e-35 + T_*(-1.712363152903046585e-37 + T_*(4.029459411781936403e-40 + T_*(1.747693150697206069e-41 + T_*(1.066388332240247759e-43 + T_*(2.143873297131243608e-46)))))))))))))))))))) + Tref*(3.881751926656385980e-14 + T_*(-2.576675311887928356e-17 + T_*(-1.603969799240775658e-16 + T_*(9.952402608858363567e-18 + T_*(-6.055225034634941582e-20 + T_*(-1.235442939516748010e-20 + T_*(3.920907488205551863e-22 + T_*(9.194360528006327083e-25 + T_*(-2.998895135752344100e-25 + T_*(5.073443579913820664e-27 + T_*(1.087894913347349155e-28 + T_*(-3.589575141677817448e-30 + T_*(-3.146974439367138782e-32 + T_*(1.218389736350877095e-33 + T_*(1.070117711199902800e-35 + T_*(-2.063712355197262881e-37 + T_*(-2.720846526279689732e-39 + T_*(7.385492218170752370e-42 + T_*(2.809174368758104302e-43 + T_*(1.671400157626875883e-45 + T_*(3.297951083432484341e-48)))))))))))))))))))) + Tref*(2.876480568679436440e-16 + T_*(-4.344823222677229388e-18 + T_*(-1.262521485120031754e-18 + T_*(8.805467760372583325e-20 + T_*(-8.365738664063348052e-22 + T_*(-9.800892035257056925e-23 + T_*(3.394261289891858437e-24 + T_*(2.788342387556792038e-27 + T_*(-2.421398520121136891e-27 + T_*(4.114670371625793313e-29 + T_*(8.366481861800155190e-31 + T_*(-2.756509868554678903e-32 + T_*(-2.304648006999264226e-34 + T_*(9.134317383087802107e-36 + T_*(7.681516192317118465e-38 + T_*(-1.535526801080069017e-39 + T_*(-1.957549963398145926e-41 + T_*(5.740781129905764004e-44 + T_*(2.031447866967367198e-45 + T_*(1.189159934764147264e-47 + T_*(2.316916843129961379e-50)))))))))))))))))))) + Tref*(8.724090607580491175e-19 + T_*(-2.558977445579069063e-20 + T_*(-3.598660609080255767e-21 + T_*(2.859046657440913304e-22 + T_*(-3.584694510672381405e-24 + T_*(-2.876892653190565164e-25 + T_*(1.087185749176498478e-26 + T_*(-5.551125343947024027e-30 + T_*(-7.329911131542891862e-30 + T_*(1.257295724289385449e-31 + T_*(2.443083608499941081e-33 + T_*(-8.023302778095840629e-35 + T_*(-6.492954428137450986e-37 + T_*(2.600955825874173656e-38 + T_*(2.122784032034375012e-40 + T_*(-4.335398594282496643e-42 + T_*(-5.398199373326291388e-44 + T_*(1.663732653741312574e-46 + T_*(5.611614099905582726e-48 + T_*(3.244777802244406886e-50 + T_*(6.259279535483407617e-53))))))))))))))))))))))))))))))  # noqa: E501

    # Return theta-w converted to K
    return thw + 273.15


@vectorize(nopython=True, cache=True)
def temp(p, thw):
    """
    Computes the temperature T at pressure p on a pseudoadiabat with
    wet-bulb potential temperature thw.

    Uses polynomial approximations from Moisseeva and Stull (2017) with
    revised coefficients.

    Moisseeva, N. and Stull, R., 2017. A noniterative approach to
        modelling moist thermodynamics. Atmospheric Chemistry and
        Physics, 17, 15037-15043.

    Args:
        p: pressure (Pa)
        thw: wet-bulb potential temperature (K)

    Returns:
        T: temperature (K)

    """

    # Convert p to hPa and theta-w to degC
    p_ = p / 100.
    thw_ = thw - 273.15

    # Check that values fall in the permitted range
    if (thw_ < -50.) or (thw_ > 50.) or (p_ > 1100.) or (p_ < 100.):
        # print('thw or p outside limits of polynomial fit', thw_, p_)
        return np.nan

    # Compute T using Eq. 1-3 from Moisseeva & Stull 2017
    thref = -1.859175479460186580e+02 + p_*(1.606103248747315027e+00 + p_*(-1.401506683901028102e-02 + p_*(1.117971746529066395e-04 + p_*(-6.930453621308009313e-07 + p_*(3.259047151551296332e-09 + p_*(-1.144728612899521084e-11 + p_*(2.929221080197128157e-14 + p_*(-5.235587462590218329e-17 + p_*(5.929518999307853743e-20 + p_*(-2.840698447225478434e-23 + p_*(-2.303553940876619605e-26 + p_*(4.057648861065361521e-29 + p_*(-4.414546596186246796e-33 + p_*(-3.273318034853090715e-35 + p_*(2.066209098726300347e-38 + p_*(1.761949977870401974e-41 + p_*(-3.323533566446424817e-44 + p_*(2.135532700826714996e-47 + p_*(-6.699428287946248091e-51 + p_*(8.621842702417080887e-55))))))))))))))))))))  # noqa: E501
    T = -2.893157595465359933e+01 + thw_*(1.337105488467820180e+00 + thw_*(9.893530356771764248e-03 + thw_*(-6.055727019021119078e-05 + thw_*(-8.117490535805783997e-06 + thw_*(-1.581335444635673068e-07 + thw_*(4.033043226146281826e-09 + thw_*(3.056764014943684817e-10 + thw_*(1.418424583004650561e-12 + thw_*(-3.306973790965527055e-13 + thw_*(-4.969409602205135722e-15 + thw_*(2.381187736401698897e-16 + thw_*(4.813325880692139797e-18 + thw_*(-1.141142138664419494e-19 + thw_*(-2.623300169139563644e-21 + thw_*(3.473863984120400880e-23 + thw_*(8.503381169693051950e-25 + thw_*(-6.053297701918763843e-27 + thw_*(-1.528632697453510545e-28 + thw_*(4.584691637111708769e-31 + thw_*(1.174623713842581885e-32)))))))))))))))))))) + thref*(1.428030453997394700e+00 + thw_*(-8.012130375608194841e-03 + thw_*(-6.778670507661330169e-04 + thw_*(-1.479879338871283395e-05 + thw_*(1.718375024315812066e-07 + thw_*(2.979879446370297395e-08 + thw_*(1.011032550984749377e-09 + thw_*(-2.526622839332140609e-11 + thw_*(-2.264734912521859896e-12 + thw_*(6.377013321192710410e-15 + thw_*(2.619885614101157349e-15 + thw_*(7.482074997754072476e-18 + thw_*(-1.901908203554037423e-18 + thw_*(-8.221467258350799217e-21 + thw_*(8.897216303488489346e-22 + thw_*(3.620232301644546802e-24 + thw_*(-2.602519951425386766e-25 + thw_*(-7.849042293193745880e-28 + thw_*(4.328925894094674066e-29 + thw_*(6.874886192980047204e-32 + thw_*(-3.124369072513461821e-33)))))))))))))))))))) + thref*(4.902434424235590886e-03 + thw_*(-5.396176002068028181e-04 + thw_*(-8.576309766189684145e-06 + thw_*(7.933780308881095207e-07 + thw_*(5.323816007498856273e-08 + thw_*(4.617570704881553575e-10 + thw_*(-1.096693572047890897e-10 + thw_*(-3.738779266204318273e-12 + thw_*(1.215693430481013093e-13 + thw_*(6.545624682045278878e-15 + thw_*(-7.579005715599853776e-17 + thw_*(-6.171056214791327834e-18 + thw_*(2.171179364269057585e-20 + thw_*(3.493494001499921092e-21 + thw_*(2.265972673188419006e-24 + thw_*(-1.185876799638351866e-24 + thw_*(-3.696916724669150692e-27 + thw_*(2.226079737048573159e-28 + thw_*(1.047087532923796075e-30 + thw_*(-1.777388779115959120e-32 + thw_*(-1.027485188069510714e-34)))))))))))))))))))) + thref*(-1.694545658551297959e-04 + thw_*(-3.645426783671706580e-06 + thw_*(6.827189296717104622e-07 + thw_*(3.676038055676841627e-08 + thw_*(-4.356935604732162734e-11 + thw_*(-1.228789445529071712e-10 + thw_*(-4.928687950955950685e-12 + thw_*(2.043076972178387961e-13 + thw_*(1.367182245130644370e-14 + thw_*(-1.953985319931326335e-16 + thw_*(-1.886762993088001715e-17 + thw_*(1.116418856730232498e-19 + thw_*(1.555672509567937255e-20 + thw_*(-3.693133357034299687e-23 + thw_*(-7.983159779543886500e-24 + thw_*(6.113882253762802379e-27 + thw_*(2.501973399170767702e-27 + thw_*(-2.247325576071831583e-31 + thw_*(-4.387751889883082885e-31 + thw_*(-4.061994475621047247e-35 + thw_*(3.301413978530834716e-35)))))))))))))))))))) + thref*(-3.085854715714912025e-06 + thw_*(3.346524756200914600e-07 + thw_*(2.323620009568532965e-08 + thw_*(-7.433621383701024607e-10 + thw_*(-1.213919848032144132e-10 + thw_*(-1.516958261505952700e-12 + thw_*(3.157407795004129615e-13 + thw_*(9.055248037460398125e-15 + thw_*(-4.683881176396394718e-16 + thw_*(-1.697836522473783667e-17 + thw_*(4.258591674951058820e-19 + thw_*(1.710789666725147205e-20 + thw_*(-2.429801702639311475e-22 + thw_*(-1.020022924118522514e-23 + thw_*(8.567111666389174853e-26 + thw_*(3.601937687530060649e-27 + thw_*(-1.748449334294571286e-29 + thw_*(-6.969569601842335453e-31 + thw_*(1.743000015825375164e-33 + thw_*(5.697986138497664070e-35 + thw_*(-4.821575263477399027e-38)))))))))))))))))))) + thref*(3.902630894019146426e-08 + thw_*(7.976804221376356761e-09 + thw_*(-7.646424818055906166e-11 + thw_*(-5.055390156810259020e-11 + thw_*(-2.251439191811657014e-12 + thw_*(1.488129726510078221e-13 + thw_*(1.226319653901823420e-14 + thw_*(-2.303237301950287330e-16 + thw_*(-2.898258203139414768e-17 + thw_*(1.944264400104541352e-19 + thw_*(3.879266720142922341e-20 + thw_*(-8.156453545030568539e-23 + thw_*(-3.190316855561313151e-23 + thw_*(5.950679425473461158e-27 + thw_*(1.644729319679168425e-26 + thw_*(8.588672100766258633e-30 + thw_*(-5.185643905602887775e-30 + thw_*(-3.234394651211431637e-33 + thw_*(9.145228131938038208e-34 + thw_*(3.665098738392765148e-37 + thw_*(-6.913703216262768253e-38)))))))))))))))))))) + thref*(1.652751227674686322e-09 + thw_*(-5.290233495137879865e-11 + thw_*(-1.766323042894703759e-11 + thw_*(-2.183048166867751400e-13 + thw_*(7.298035861847681406e-14 + thw_*(2.999096667235586811e-15 + thw_*(-1.473346924932653841e-16 + thw_*(-9.844135336548157825e-18 + thw_*(1.457700686464506725e-19 + thw_*(1.616859255104443017e-20 + thw_*(-4.250361942967444875e-23 + thw_*(-1.543260500840194421e-23 + thw_*(-5.076714412622892704e-26 + thw_*(8.939769338161475348e-27 + thw_*(5.942060535403143221e-29 + thw_*(-3.100076977709388389e-30 + thw_*(-2.707980232893380905e-32 + thw_*(5.922059374099248458e-34 + thw_*(5.991215871829870696e-36 + thw_*(-4.794217558924313758e-38 + thw_*(-5.308085881283384568e-40)))))))))))))))))))) + thref*(1.810908060605227876e-11 + thw_*(-4.420967434504342822e-12 + thw_*(-4.010724441178789077e-13 + thw_*(2.248226706818765174e-14 + thw_*(3.119134133627462791e-15 + thw_*(-3.285675562440791464e-17 + thw_*(-1.143990848621196089e-17 + thw_*(-2.592153589662226684e-20 + thw_*(2.337383318492239198e-20 + thw_*(1.408324581685158389e-22 + thw_*(-2.901698556661056570e-23 + thw_*(-1.923220206270194454e-25 + thw_*(2.277206305912384123e-26 + thw_*(1.354268372961895265e-28 + thw_*(-1.135995302532842135e-29 + thw_*(-5.342018564440578911e-32 + thw_*(3.492670460814713512e-33 + thw_*(1.120732277393291170e-35 + thw_*(-6.034975477510211125e-37 + thw_*(-9.752675533934912408e-40 + thw_*(4.484085187660701203e-41)))))))))))))))))))) + thref*(5.966199353400893505e-14 + thw_*(-6.860685763200345106e-14 + thw_*(-4.211413052281339763e-15 + thw_*(4.669692563973408849e-16 + thw_*(4.396321269999172517e-17 + thw_*(-1.346217542746704923e-18 + thw_*(-1.863662035883654411e-19 + thw_*(2.030546479207722252e-21 + thw_*(4.184661218742626137e-22 + thw_*(-1.632726891604475818e-24 + thw_*(-5.571217192545138892e-25 + thw_*(5.726986034601433891e-28 + thw_*(4.620379468954509138e-28 + thw_*(7.504311146293315539e-32 + thw_*(-2.411642308866231316e-31 + thw_*(-1.357100750261019141e-34 + thw_*(7.702640790463417086e-35 + thw_*(4.307488680194430546e-38 + thw_*(-1.375166440760186161e-38 + thw_*(-4.660591922206960177e-42 + thw_*(1.051296029265250398e-42)))))))))))))))))))) + thref*(-2.463881349185597127e-16 + thw_*(-4.625323707815973809e-16 + thw_*(-2.168657960214759548e-17 + thw_*(3.622090347412632086e-18 + thw_*(2.795689450123212320e-19 + thw_*(-1.256498850861635597e-20 + thw_*(-1.284262339739811984e-21 + thw_*(2.427536567251870183e-23 + thw_*(3.026295355555881069e-24 + thw_*(-2.826450352180285165e-26 + thw_*(-4.170431028598639603e-27 + thw_*(2.047053682991098805e-29 + thw_*(3.551992840319091969e-30 + thw_*(-9.221197199393476244e-33 + thw_*(-1.894165799139689578e-33 + thw_*(2.491421760074979064e-36 + thw_*(6.158125190675583284e-37 + thw_*(-3.654243270738107395e-40 + thw_*(-1.116003651815402182e-40 + thw_*(2.198382583192655490e-44 + thw_*(8.641861619891417468e-45)))))))))))))))))))) + thref*(-1.594789120146039176e-18 + thw_*(-1.188364870498442837e-18 + thw_*(-4.400613072395174275e-20 + thw_*(1.015556317639323212e-20 + thw_*(6.795269093400700177e-22 + thw_*(-3.873146176219314026e-23 + thw_*(-3.299676903209578153e-24 + thw_*(8.255826356740126810e-26 + thw_*(8.026078937534699722e-27 + thw_*(-1.064779777120052148e-28 + thw_*(-1.131133982863884980e-29 + thw_*(8.599747921168604423e-32 + thw_*(9.802438834780283167e-33 + thw_*(-4.367318082665813528e-35 + thw_*(-5.301101185029895107e-36 + thw_*(1.352704541195885118e-38 + thw_*(1.743617293217773223e-39 + thw_*(-2.332535812599315992e-42 + thw_*(-3.191137627173173570e-43 + thw_*(1.715253082749470493e-46 + thw_*(2.492060794159690811e-47))))))))))))))))))))))))))))))  # noqa: E501

    # Return T converted to K
    return T + 273.15
