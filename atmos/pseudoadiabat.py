# *** This file is generated by pseudoadiabat_codegen/pseudoadiabat_codegen.py ***
# *** Please ensure any updates are made in pseudoadiabat_codegen.py           ***
import numpy as np
from numba import vectorize


@vectorize(nopython=True, cache=True)
def wbpt(p, T):
    """
    Computes the wet-bulb potential temperature (WBPT) thw of the
    pseudoadiabat that passes through pressure p and temperature T.

    Uses polynomial approximations from Moisseeva and Stull (2017)
    with revised coefficients.

    Moisseeva, N. and Stull, R., 2017. A noniterative approach to
        modelling moist thermodynamics. Atmospheric Chemistry and
        Physics, 17, 15037-15043.

    Args:
        p: pressure (Pa)
        T: temperature (K)

    Returns:
        thw: wet-bulb potential temperature (K)

    """

    # Convert p to hPa and T to degC
    p_ = p / 100.
    T_ = T - 273.15

    # Check that values fall in the permitted range
    if (T_ < -100.) or (T_ > 50.) or (p_ > 1100.) or (p_ < 100.):
        # print('T or p outside limits of polynomial fit', T_, p_)
        return np.nan

    # Compute theta-w using Eq. 4-6 from Moisseeva & Stull 2017
    Tref = 5.461425898865910256e+01 + p_*(-5.887534568323852247e-01 + p_*(7.043561993873816846e-03 + p_*(-8.252369427254289415e-05 + p_*(6.677271393625228575e-07 + p_*(-3.777124104060974918e-09 + p_*(1.486039982153878700e-11 + p_*(-4.028911822361222774e-14 + p_*(7.327584113665210312e-17 + p_*(-8.175315984090708771e-20 + p_*(3.650468507619825770e-23 + p_*(3.234334937403086499e-26 + p_*(-4.980330549510498306e-29 + p_*(6.225347352524237641e-34 + p_*(3.980427756816309481e-35 + p_*(-1.907913357863055889e-38 + p_*(-2.300918370261490867e-41 + p_*(3.407202835512856150e-44 + p_*(-1.892222028241530814e-47 + p_*(5.112094787167627266e-51 + p_*(-5.537684945816567368e-55))))))))))))))))))))  # noqa: E501
    thw = 4.204583815195430674e+01 + T_*(5.636124240350236514e-01 + T_*(6.566586662298294456e-03 + T_*(4.028806146917654160e-05 + T_*(-9.202407832462957091e-07 + T_*(-7.737756138985362617e-09 + T_*(1.666215771424767824e-10 + T_*(2.283883187131718007e-12 + T_*(-3.233648435871204220e-14 + T_*(-6.789271399429577560e-16 + T_*(4.115913180325871868e-18 + T_*(1.955085161767881231e-19 + T_*(6.602609685594191917e-22 + T_*(-3.873711327320427889e-23 + T_*(-5.312321297201318021e-25 + T_*(1.152792469782827463e-27 + T_*(8.690744162912456323e-29 + T_*(8.593653918009063140e-31 + T_*(3.636562729049565054e-33 + T_*(5.293652023592264166e-36 + T_*(-2.978561800941201775e-39)))))))))))))))))))) + Tref*(3.551973023491836190e-01 + T_*(8.603994292170917459e-04 + T_*(7.450769812742354310e-05 + T_*(-3.022907160172917994e-07 + T_*(-1.070835176331947841e-08 + T_*(3.304553215869941254e-11 + T_*(3.302102991868922773e-12 + T_*(4.950639656856034679e-15 + T_*(-1.037753610168612798e-15 + T_*(-1.143807045742608962e-17 + T_*(6.128427049761735309e-19 + T_*(6.491133612909312216e-21 + T_*(-3.236044577421186966e-22 + T_*(-3.883111287340045289e-24 + T_*(9.012223872551605800e-26 + T_*(1.723416996573246936e-27 + T_*(-2.701922054181923966e-30 + T_*(-2.881852017515652579e-31 + T_*(-2.884528447070813386e-33 + T_*(-1.235171183294947150e-35 + T_*(-2.037639691727091939e-38)))))))))))))))))))) + Tref*(2.789893674622678354e-03 + T_*(6.228845110246611534e-05 + T_*(7.470108743885659462e-07 + T_*(-8.097254508175419442e-09 + T_*(-2.032671315371116792e-10 + T_*(3.186335727167266002e-12 + T_*(4.745957947490967667e-14 + T_*(-1.805251788244868126e-16 + T_*(-2.226327697943632027e-17 + T_*(-1.772275416258543377e-19 + T_*(1.453890759617702203e-20 + T_*(2.511950974788213178e-23 + T_*(-6.590823115517637452e-24 + T_*(-3.829390443586377809e-27 + T_*(1.901611939257521519e-27 + T_*(9.937421013772143093e-30 + T_*(-2.403913103958668490e-31 + T_*(-3.059146408617576202e-33 + T_*(-1.016157767002201096e-35 + T_*(1.508556848699310820e-38 + T_*(1.067309539136239794e-40)))))))))))))))))))) + Tref*(6.511335536161437336e-05 + T_*(1.108535000960181057e-06 + T_*(1.589918844821534821e-08 + T_*(-1.313564470794158497e-10 + T_*(-6.062694771587767103e-12 + T_*(4.819626696218597998e-15 + T_*(5.855878467376516338e-15 + T_*(-4.765418142696050819e-17 + T_*(-1.753255119669526939e-18 + T_*(3.788366850298140709e-20 + T_*(-1.263224647463737719e-21 + T_*(-1.583594336469582632e-23 + T_*(1.367149544764071278e-24 + T_*(1.358860054394839322e-26 + T_*(-4.756306497982344855e-28 + T_*(-8.030018802078193784e-30 + T_*(2.451047176883377064e-32 + T_*(1.526538146254124806e-33 + T_*(1.475270211518209264e-35 + T_*(6.224590194148466561e-38 + T_*(1.017310862435934469e-40)))))))))))))))))))) + Tref*(5.380519594843103472e-07 + T_*(2.536529537093211957e-08 + T_*(1.615530328312878416e-10 + T_*(-2.075783862605649376e-12 + T_*(-1.837211019022045624e-13 + T_*(1.502076143947339125e-15 + T_*(1.809397724280524383e-16 + T_*(-3.043271888384077849e-18 + T_*(-5.246378747497860550e-20 + T_*(1.571046330204977776e-21 + T_*(-1.949595848122183608e-23 + T_*(-2.667123106995979224e-25 + T_*(2.308401473922615775e-26 + T_*(1.045993140059686576e-28 + T_*(-8.691042773484685710e-30 + T_*(-9.421323861718599526e-32 + T_*(8.596868731433886549e-34 + T_*(2.257112504280260854e-35 + T_*(1.724168151090591029e-37 + T_*(5.956319591961626837e-40 + T_*(7.884897909458537978e-43)))))))))))))))))))) + Tref*(6.210065379437991506e-09 + T_*(3.872845648097191955e-10 + T_*(3.059837588830748860e-12 + T_*(-2.501652050153127186e-13 + T_*(1.800140965480315637e-15 + T_*(1.863237391702474598e-16 + T_*(-4.601907453616682398e-18 + T_*(-2.354987677958958720e-20 + T_*(9.623953197712356243e-22 + T_*(-1.980549293444917380e-23 + T_*(2.159841988078071795e-24 + T_*(1.545113205948760707e-26 + T_*(-1.933703962126546868e-27 + T_*(-1.818002338059585025e-29 + T_*(6.404389935328514368e-31 + T_*(1.082492563590513619e-32 + T_*(-3.032984267487508230e-35 + T_*(-2.017771362120517119e-36 + T_*(-1.969121300761683786e-38 + T_*(-8.375708999411902258e-41 + T_*(-1.380188621962554126e-43)))))))))))))))))))) + Tref*(1.330079568223208464e-10 + T_*(6.563156530603597017e-12 + T_*(1.280096169692719601e-14 + T_*(-7.125890676956568502e-15 + T_*(1.797316842637880720e-16 + T_*(3.852733532129557540e-18 + T_*(-2.225765147375129010e-19 + T_*(1.396033699026418143e-21 + T_*(5.349065934941836618e-23 + T_*(-1.254051636099090206e-24 + T_*(5.205867505718659646e-26 + T_*(3.149763227820383294e-28 + T_*(-4.934456731100748778e-29 + T_*(-3.268998213074642537e-31 + T_*(1.710565641603540152e-32 + T_*(2.366417398546151921e-34 + T_*(-1.214044919481555037e-36 + T_*(-4.886695161882927441e-38 + T_*(-4.349243551902821339e-40 + T_*(-1.734429872383456811e-42 + T_*(-2.701221689546417790e-45)))))))))))))))))))) + Tref*(3.199620953731267749e-12 + T_*(7.999781564139099087e-14 + T_*(-1.534133914581797251e-15 + T_*(-1.057799914905186374e-17 + T_*(1.861020352975337701e-18 + T_*(-2.003388360952018826e-20 + T_*(-5.222853950162843608e-22 + T_*(9.350214812449385160e-24 + T_*(3.047489583229489552e-25 + T_*(5.352964933442884357e-27 + T_*(-5.684557052111904161e-28 + T_*(-7.489203184538611263e-30 + T_*(4.134884558967549999e-31 + T_*(6.012617858015323047e-33 + T_*(-1.207262983347541723e-34 + T_*(-2.714790159160572686e-36 + T_*(6.272880627071161855e-40 + T_*(4.344791745986627462e-40 + T_*(4.701276797789817357e-42 + T_*(2.118228170001661310e-44 + T_*(3.646011258543244711e-47)))))))))))))))))))) + Tref*(4.452971622960527571e-14 + T_*(4.520400589187392550e-16 + T_*(-3.794247431810164280e-17 + T_*(2.104323858028348398e-18 + T_*(-3.063618008678779291e-20 + T_*(-1.344184004979836727e-21 + T_*(6.886053754155160178e-23 + T_*(-6.658646048311099126e-25 + T_*(-9.942743761945840877e-27 + T_*(6.709161752650791554e-28 + T_*(-2.946520095468395421e-29 + T_*(-2.719545540561940407e-31 + T_*(2.426335610413713732e-32 + T_*(2.184212326182496019e-34 + T_*(-7.889240698749814950e-36 + T_*(-1.262209906824798214e-37 + T_*(4.266301147827428502e-40 + T_*(2.381382934781450094e-41 + T_*(2.249196739849253676e-43 + T_*(9.341871355328730187e-46 + T_*(1.507835252545996569e-48)))))))))))))))))))) + Tref*(3.296321253378474872e-16 + T_*(-1.104297746502710084e-18 + T_*(-3.262620579947482343e-19 + T_*(2.909460667484394760e-20 + T_*(-6.647370638897423141e-22 + T_*(-1.317902343944847675e-23 + T_*(9.627521972504969102e-25 + T_*(-1.146510820564252161e-26 + T_*(-1.443382104220533952e-28 + T_*(8.684925802818523537e-30 + T_*(-3.259352538033801911e-31 + T_*(-2.795080004667133240e-33 + T_*(2.679586747222107320e-34 + T_*(2.153885628503992498e-36 + T_*(-8.806907122998212736e-38 + T_*(-1.318378634931147420e-39 + T_*(5.423992799892924202e-42 + T_*(2.569952542490976735e-43 + T_*(2.357330654410307983e-45 + T_*(9.596377816919540419e-48 + T_*(1.522292720764712651e-50)))))))))))))))))))) + Tref*(9.903407990525067893e-19 + T_*(-1.707319491439393760e-20 + T_*(-8.634328300626040204e-22 + T_*(1.163235303493396149e-22 + T_*(-3.220519055986300739e-24 + T_*(-3.829949196997077296e-26 + T_*(3.867546149128976139e-27 + T_*(-5.290476224027179743e-29 + T_*(-5.453965373170835020e-31 + T_*(3.464395418948060368e-32 + T_*(-1.182652098227590948e-33 + T_*(-9.765856377075828960e-36 + T_*(9.593362810510471586e-37 + T_*(7.197344374530252595e-39 + T_*(-3.161680748680056675e-40 + T_*(-4.551507366288471292e-42 + T_*(2.076135922673359886e-44 + T_*(9.039038593311131978e-46 + T_*(8.145901302510085533e-48 + T_*(3.274463879986741913e-50 + T_*(5.136397851072615740e-53))))))))))))))))))))))))))))))  # noqa: E501

    # Return theta-w converted to K
    return thw + 273.15


@vectorize(nopython=True, cache=True)
def temp(p, thw):
    """
    Computes the temperature T at pressure p on a pseudoadiabat with
    wet-bulb potential temperature thw.

    Uses polynomial approximations from Moisseeva and Stull (2017) with
    revised coefficients.

    Moisseeva, N. and Stull, R., 2017. A noniterative approach to
        modelling moist thermodynamics. Atmospheric Chemistry and
        Physics, 17, 15037-15043.

    Args:
        p: pressure (Pa)
        thw: wet-bulb potential temperature (K)

    Returns:
        T: temperature (K)

    """

    # Convert p to hPa and theta-w to degC
    p_ = p / 100.
    thw_ = thw - 273.15

    # Check that values fall in the permitted range
    if (thw_ < -50.) or (thw_ > 50.) or (p_ > 1100.) or (p_ < 100.):
        # print('thw or p outside limits of polynomial fit', thw_, p_)
        return np.nan

    # Compute T using Eq. 1-3 from Moisseeva & Stull 2017
    thref = -1.942884286892313810e+02 + p_*(2.033157875206305309e+00 + p_*(-2.343912495880924943e-02 + p_*(2.330643947858411199e-04 + p_*(-1.707760217323654022e-06 + p_*(9.090961136859248482e-09 + p_*(-3.509546699881795323e-11 + p_*(9.735107926670808931e-14 + p_*(-1.887754378885157864e-16 + p_*(2.370568861390410659e-19 + p_*(-1.439949119081905616e-22 + p_*(-6.079355487994388289e-26 + p_*(1.689879163526504008e-28 + p_*(-4.775427576609294950e-32 + p_*(-1.272898499415633983e-34 + p_*(1.075749159514048979e-37 + p_*(6.135845858546046974e-41 + p_*(-1.538417380810166181e-43 + p_*(1.098057297887461032e-46 + p_*(-3.735065783067467196e-50 + p_*(5.166262152029967435e-54))))))))))))))))))))  # noqa: E501
    T = -2.905781979522405578e+01 + thw_*(1.338928276917128013e+00 + thw_*(1.000830791595522587e-02 + thw_*(-5.219870347793596240e-05 + thw_*(-7.480960452327542704e-06 + thw_*(-1.587653283270066029e-07 + thw_*(1.076960324289152902e-09 + thw_*(2.180835402831254797e-10 + thw_*(6.835426033507584320e-12 + thw_*(-6.732065491882965797e-14 + thw_*(-9.098745693704876340e-15 + thw_*(-1.195382507807495518e-16 + thw_*(4.565397733559480385e-18 + thw_*(1.386248852548425894e-19 + thw_*(-1.860726107699695016e-22 + thw_*(-5.319186162876287478e-23 + thw_*(-6.099930621318407384e-25 + thw_*(4.225346212135395096e-27 + thw_*(1.467448821756395402e-28 + thw_*(1.207042719796190790e-30 + thw_*(3.483978434077297834e-33)))))))))))))))))))) + thref*(1.433043905091968773e+00 + thw_*(-7.859459103264783073e-03 + thw_*(-6.782202532495419916e-04 + thw_*(-1.569654696991279659e-05 + thw_*(9.460928569524935327e-08 + thw_*(2.723170962545642578e-08 + thw_*(1.215824258000848801e-09 + thw_*(-4.265301849851025770e-12 + thw_*(-2.246769464707081271e-12 + thw_*(-4.399482055989096714e-14 + thw_*(1.755295738272002675e-15 + thw_*(6.617826789993309160e-17 + thw_*(-3.713540880024393482e-19 + thw_*(-4.259515580439023337e-20 + thw_*(-3.282695504364072296e-22 + thw_*(1.165801276257978393e-23 + thw_*(2.180708016077297950e-25 + thw_*(-1.823631753162859208e-28 + thw_*(-3.602554328888674759e-29 + thw_*(-3.475023438668094631e-31 + thw_*(-1.086549629570640232e-33)))))))))))))))))))) + thref*(5.053492814121716796e-03 + thw_*(-5.219457456786157556e-04 + thw_*(-7.595448407898323433e-06 + thw_*(6.366991894604618273e-07 + thw_*(3.493311736691443009e-08 + thw_*(6.717367210292382618e-10 + thw_*(-2.246499660714160736e-11 + thw_*(-2.581295570716501933e-12 + thw_*(-6.778281196429536135e-14 + thw_*(1.914246334206373747e-15 + thw_*(1.328416499360359568e-16 + thw_*(8.883412478420097600e-19 + thw_*(-8.636894112413668145e-20 + thw_*(-1.935984146025458420e-21 + thw_*(1.264031435673436518e-23 + thw_*(9.039197307498662069e-25 + thw_*(8.284279843985317275e-27 + thw_*(-9.437405977132822716e-29 + thw_*(-2.501135381363664355e-30 + thw_*(-1.937663032692988525e-32 + thw_*(-5.413122051909437233e-35)))))))))))))))))))) + thref*(-1.717465108738451725e-04 + thw_*(-4.569383920736880485e-06 + thw_*(6.580097304125537768e-07 + thw_*(3.890702268282846291e-08 + thw_*(3.242352266416500306e-10 + thw_*(-9.422566221276617955e-11 + thw_*(-5.766357812100189468e-12 + thw_*(2.860233996483296665e-14 + thw_*(1.239865977236324844e-14 + thw_*(2.163742130150297668e-16 + thw_*(-1.124395182598496180e-17 + thw_*(-3.765841760138932484e-19 + thw_*(3.255989592305183948e-21 + thw_*(2.649671362023345186e-22 + thw_*(1.664141488754447665e-24 + thw_*(-7.833665676775685965e-26 + thw_*(-1.348077764325999037e-27 + thw_*(2.331826119403209594e-30 + thw_*(2.388734428880345022e-31 + thw_*(2.241147625005275113e-33 + thw_*(6.924917795535455225e-36)))))))))))))))))))) + thref*(-3.351875713776048974e-06 + thw_*(2.232609707988224262e-07 + thw_*(1.825832499790781685e-08 + thw_*(7.041786704278037633e-11 + thw_*(-3.838923086706126220e-11 + thw_*(-3.036973247585514713e-12 + thw_*(-7.502222615012633468e-14 + thw_*(6.036622223533534653e-15 + thw_*(3.835718929748073357e-16 + thw_*(-9.093387621108668718e-19 + thw_*(-5.319567902810045402e-19 + thw_*(-8.568223082854660836e-21 + thw_*(2.896907865274646062e-22 + thw_*(9.641120339606091867e-24 + thw_*(-1.026073898930666534e-26 + thw_*(-3.845910558199982841e-27 + thw_*(-4.514034388747636678e-29 + thw_*(3.176129224657101558e-31 + thw_*(1.116648131759040291e-32 + thw_*(9.276547345226437882e-35 + thw_*(2.699910108943903196e-37)))))))))))))))))))) + thref*(3.668682702813316437e-08 + thw_*(6.996314530471486253e-09 + thw_*(-1.270752191623888167e-10 + thw_*(-3.572037869604161378e-11 + thw_*(-1.256725285353984049e-12 + thw_*(5.807692928806945478e-14 + thw_*(6.174858903250122430e-15 + thw_*(5.156178849236870095e-17 + thw_*(-1.066791475600969972e-17 + thw_*(-2.852019897860071170e-19 + thw_*(7.768534998456998019e-21 + thw_*(3.740889316508873048e-22 + thw_*(-7.222968914809520407e-25 + thw_*(-2.231733048330404195e-25 + thw_*(-2.230606076325870265e-27 + thw_*(5.482659731439622176e-29 + thw_*(1.190882785193609219e-30 + thw_*(7.384682892447595412e-34 + thw_*(-1.744508486981888547e-34 + thw_*(-1.778810313975783828e-36 + thw_*(-5.695678369889341119e-39)))))))))))))))))))) + thref*(1.929321501766029548e-09 + thw_*(7.593131750735442828e-11 + thw_*(-1.263054773615081434e-11 + thw_*(-1.083062023391516390e-12 + thw_*(-1.261960802624189222e-14 + thw_*(4.107367036916166079e-15 + thw_*(2.415263674808693493e-16 + thw_*(-4.075022380691813181e-18 + thw_*(-6.421249567798083767e-19 + thw_*(-6.373404288416519402e-21 + thw_*(7.187801713135951966e-22 + thw_*(1.770374100140117153e-23 + thw_*(-3.120733484454952810e-25 + thw_*(-1.518326230895425101e-26 + thw_*(-4.143229053156814571e-29 + thw_*(5.288721289070995357e-30 + thw_*(7.482920536060508126e-32 + thw_*(-3.191537381679345472e-34 + thw_*(-1.582605986912996824e-35 + thw_*(-1.391699371443921945e-37 + thw_*(-4.172841449440770041e-40)))))))))))))))))))) + thref*(2.836554609896627526e-11 + thw_*(1.703439467738862230e-13 + thw_*(-2.346913713047095728e-13 + thw_*(-1.533503430761689877e-14 + thw_*(3.978000060801588872e-17 + thw_*(7.897464643568074226e-17 + thw_*(3.761706441526309100e-18 + thw_*(-1.156268942689368556e-19 + thw_*(-1.177410966745210060e-20 + thw_*(-5.120590588517629419e-23 + thw_*(1.468940322863315098e-23 + thw_*(2.927001912061284772e-25 + thw_*(-7.419592697571682663e-27 + thw_*(-2.883064110767657562e-28 + thw_*(-1.427745548924330593e-31 + thw_*(1.097041102901307183e-31 + thw_*(1.385765696096895194e-33 + thw_*(-8.290107164025861888e-36 + thw_*(-3.251200745521406306e-37 + thw_*(-2.760154120524302668e-39 + thw_*(-8.130431262986902446e-42)))))))))))))))))))) + thref*(2.128474011183375459e-13 + thw_*(-3.219540436046843833e-15 + thw_*(-2.098943950259772905e-15 + thw_*(-1.182237499439884267e-16 + thw_*(1.733652816434563452e-18 + thw_*(7.358185772646723342e-19 + thw_*(2.999097636090133552e-20 + thw_*(-1.283856508121134929e-21 + thw_*(-1.053221943122142398e-22 + thw_*(-4.665389471943625459e-26 + thw_*(1.405344638876603600e-25 + thw_*(2.402562447676040425e-27 + thw_*(-7.704523194066641463e-29 + thw_*(-2.630089865734384786e-30 + thw_*(2.796907856321450722e-33 + thw_*(1.060181337118013712e-33 + thw_*(1.241419407914485664e-35 + thw_*(-9.010662447498345725e-38 + thw_*(-3.126905106939858178e-39 + thw_*(-2.595652927766992221e-41 + thw_*(-7.556013287695178643e-44)))))))))))))))))))) + thref*(8.292311229741132549e-16 + thw_*(-2.662865326767399333e-17 + thw_*(-9.433285993450215404e-18 + thw_*(-4.787066717221549211e-19 + thw_*(1.240920997931594430e-20 + thw_*(3.415020324364559702e-21 + thw_*(1.210513588364463517e-22 + thw_*(-6.650900084129566079e-24 + thw_*(-4.692121996696652958e-25 + thw_*(1.336492540802173696e-27 + thw_*(6.591027162883510403e-28 + thw_*(9.848663140305079534e-30 + thw_*(-3.828791535721866775e-31 + thw_*(-1.186692241277097847e-32 + thw_*(2.818370766948574701e-35 + thw_*(5.008721101289878043e-36 + thw_*(5.512012369218156356e-38 + thw_*(-4.621062554456423358e-40 + thw_*(-1.472442976885050888e-41 + thw_*(-1.200792661589250007e-43 + thw_*(-3.462023795373218355e-46)))))))))))))))))))) + thref*(1.332797823868169692e-18 + thw_*(-6.252469697656113908e-20 + thw_*(-1.709320340155956566e-20 + thw_*(-7.984761496466965368e-22 + thw_*(2.937680692434353348e-23 + thw_*(6.333133904686446911e-24 + thw_*(1.961466118731820264e-25 + thw_*(-1.334013525662412062e-26 + thw_*(-8.345693286478897063e-28 + thw_*(4.873970568379340085e-30 + thw_*(1.223909433991745801e-30 + thw_*(1.608235837059763805e-32 + thw_*(-7.440961724926704821e-34 + thw_*(-2.129004563821218065e-35 + thw_*(7.589999813562324708e-38 + thw_*(9.350978783143795418e-39 + thw_*(9.738530416682594809e-41 + thw_*(-9.199140774670421877e-43 + thw_*(-2.741720879067510928e-44 + thw_*(-2.202050795594841479e-46 + thw_*(-6.294914746540909518e-49))))))))))))))))))))))))))))))  # noqa: E501

    # Return T converted to K
    return T + 273.15
