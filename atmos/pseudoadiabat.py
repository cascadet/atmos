# *** This file is generated by pseudoadiabat_codegen/pseudoadiabat_codegen.py ***
# *** Please ensure any updates are made in pseudoadiabat_codegen.py           ***
import numpy as np
from numba import vectorize


@vectorize(nopython=True, cache=True)
def wbpt(p, T):
    """
    Computes the wet-bulb potential temperature (WBPT) thw of the
    pseudoadiabat that passes through pressure p and temperature T.

    Uses polynomial approximations from Moisseeva and Stull (2017)
    with revised coefficients.

    Moisseeva, N. and Stull, R., 2017. A noniterative approach to
        modelling moist thermodynamics. Atmospheric Chemistry and
        Physics, 17, 15037-15043.

    Args:
        p: pressure (Pa)
        T: temperature (K)

    Returns:
        thw: wet-bulb potential temperature (K)

    """

    # Convert p to hPa and T to degC
    p_ = p / 100.
    T_ = T - 273.15

    # Check that values fall in the permitted range
    if (T_ < -100.) or (T_ > 50.) or (p_ > 1100.) or (p_ < 100.):
        # print('T or p outside limits of polynomial fit', T_, p_)
        return np.nan

    # Compute theta-w using Eq. 4-6 from Moisseeva & Stull 2017
    Tref = 5.849230460514726815e+01 + p_*(-7.834876128519160376e-01 + p_*(1.130987184227747085e-02 + p_*(-1.366225013032443389e-04 + p_*(1.111623666045022085e-06 + p_*(-6.268788493793349699e-09 + p_*(2.468961238316089365e-11 + p_*(-6.767563851550246221e-14 + p_*(1.259757799718495464e-16 + p_*(-1.462895883014801686e-19 + p_*(7.185845381119017481e-23 + p_*(5.617055186210143314e-26 + p_*(-1.009390685999980409e-28 + p_*(1.138703517718440902e-32 + p_*(8.116588777680123734e-35 + p_*(-5.128377108071380228e-38 + p_*(-4.364493809729461044e-41 + p_*(8.218814667278238715e-44 + p_*(-5.269357669998011241e-47 + p_*(1.649145343809320210e-50 + p_*(-2.117227345844311435e-54))))))))))))))))))))  # noqa: E501
    thw = 4.204607834218919038e+01 + T_*(5.636254378003867638e-01 + T_*(6.568524011431678584e-03 + T_*(4.013640566346958900e-05 + T_*(-9.184861865459316302e-07 + T_*(-7.542107952152745291e-09 + T_*(1.597134296610661686e-10 + T_*(2.243609825515669432e-12 + T_*(-2.729733146413473427e-14 + T_*(-7.141504930723744858e-16 + T_*(2.834464858174728784e-18 + T_*(2.212235414446363860e-19 + T_*(4.715752675306200666e-22 + T_*(-5.199454005490766505e-23 + T_*(-3.719356991371041322e-25 + T_*(6.952108960265987346e-27 + T_*(9.259502312829099918e-29 + T_*(-1.547096643577646192e-31 + T_*(-8.419711067371921827e-33 + T_*(-5.225655007970949340e-35 + T_*(-1.064578709535208146e-37)))))))))))))))))))) + Tref*(3.551920400128438793e-01 + T_*(8.588385409619480942e-04 + T_*(7.434802635803364884e-05 + T_*(-2.879324252281051457e-07 + T_*(-1.094362340781654178e-08 + T_*(1.818949608398769676e-11 + T_*(3.897973689667875099e-12 + T_*(4.152821362375696478e-15 + T_*(-1.233536948849834371e-15 + T_*(-5.475000828138067581e-18 + T_*(4.025561073353859792e-19 + T_*(1.819785954490973250e-21 + T_*(-1.098176358573713078e-22 + T_*(-3.927360075742866430e-25 + T_*(2.204791675312990467e-26 + T_*(8.791061015716389900e-29 + T_*(-2.870433101680312186e-30 + T_*(-1.836736460997290929e-32 + T_*(1.615884601529926952e-34 + T_*(1.872344517347699948e-36 + T_*(4.949364825079797715e-39)))))))))))))))))))) + Tref*(2.785404322788585362e-03 + T_*(6.200540376789402458e-05 + T_*(6.970424954147053702e-07 + T_*(-4.478553630959508259e-09 + T_*(-2.341786795810219303e-10 + T_*(-1.379029372250063776e-12 + T_*(1.990313504058354960e-13 + T_*(6.250190395848370481e-17 + T_*(-1.362758119753223576e-16 + T_*(1.860280417496380103e-18 + T_*(5.396563884925911561e-20 + T_*(-1.416954524994272260e-21 + T_*(-1.687172975856953786e-23 + T_*(5.025096967508777093e-25 + T_*(5.448230451777615384e-27 + T_*(-8.551842110489926762e-29 + T_*(-1.296884572187064025e-30 + T_*(2.463836483193546582e-33 + T_*(1.290154689136171823e-34 + T_*(8.045878586924905828e-37 + T_*(1.636104653868955605e-39)))))))))))))))))))) + Tref*(6.503019781995806562e-05 + T_*(1.111572737153127856e-06 + T_*(1.599350587579126944e-08 + T_*(-1.500039359120444601e-10 + T_*(-5.373819651620799439e-12 + T_*(1.152862284775037168e-14 + T_*(5.064933480015043785e-15 + T_*(-3.825603377056093586e-17 + T_*(-2.428304630357629216e-18 + T_*(3.707775791874646402e-20 + T_*(4.409315945580261741e-22 + T_*(-1.366477883717104687e-23 + T_*(4.553226429153251110e-26 + T_*(2.826892114568091557e-27 + T_*(-3.704138077997230437e-29 + T_*(-4.734893948501202818e-31 + T_*(6.848938172952167807e-33 + T_*(7.433782146328095496e-35 + T_*(-3.780365301106839923e-37 + T_*(-6.287573400039321646e-39 + T_*(-1.861159768273171650e-41)))))))))))))))))))) + Tref*(5.487492870117659176e-07 + T_*(2.630765604885935112e-08 + T_*(3.522572847561524644e-10 + T_*(-1.541748421112509967e-11 + T_*(-8.498421448431468387e-14 + T_*(1.867556349015089751e-14 + T_*(-3.724341494360467028e-16 + T_*(-4.266506709489591809e-18 + T_*(3.672146991292126991e-19 + T_*(-5.903296313762579174e-21 + T_*(-1.581921062506150928e-22 + T_*(5.168006342500722414e-24 + T_*(5.382321537518582559e-26 + T_*(-1.903344602651894992e-27 + T_*(-1.936228116548821597e-29 + T_*(3.301066253053724266e-31 + T_*(4.872758814259637322e-33 + T_*(-9.890018461655796775e-36 + T_*(-4.945456759315141584e-37 + T_*(-3.092559103578664593e-39 + T_*(-6.326875666955552838e-42)))))))))))))))))))) + Tref*(6.591453188988114883e-09 + T_*(4.048523062528423104e-10 + T_*(7.669108680204083501e-12 + T_*(-5.487620161600445213e-13 + T_*(2.937478467922706026e-15 + T_*(6.059166389820313130e-16 + T_*(-1.693885944011090245e-17 + T_*(-7.913276729212326504e-20 + T_*(1.260741832824243462e-20 + T_*(-1.969363239256330210e-22 + T_*(-4.238577835750521644e-24 + T_*(1.436642455987850977e-25 + T_*(1.081266603778557325e-27 + T_*(-4.910811971651085609e-29 + T_*(-3.660143409538487780e-31 + T_*(8.516421467156434861e-33 + T_*(9.905198050762222519e-35 + T_*(-3.682916048311030587e-37 + T_*(-1.072905746973878350e-38 + T_*(-6.005820415044206763e-41 + T_*(-1.128691108876846268e-43)))))))))))))))))))) + Tref*(1.313488239565154872e-10 + T_*(5.969763282213258564e-12 + T_*(-1.186832180737089606e-13 + T_*(1.977562719508692730e-15 + T_*(1.131829869108572304e-16 + T_*(-7.809134744989754009e-18 + T_*(1.514111961278129813e-19 + T_*(2.247096232464361014e-21 + T_*(-2.103689013969307689e-22 + T_*(3.697003507307390917e-24 + T_*(1.097182227266821635e-25 + T_*(-3.416926256818919951e-27 + T_*(-4.262063960375021040e-29 + T_*(1.285930412826311629e-30 + T_*(1.533560909362097841e-32 + T_*(-2.196010896282370935e-34 + T_*(-3.686435949466490355e-36 + T_*(4.587809860770132197e-39 + T_*(3.599389950331379656e-40 + T_*(2.365062103159640120e-42 + T_*(4.999362481153249573e-45)))))))))))))))))))) + Tref*(2.936588047901009199e-12 + T_*(5.303920701120019470e-14 + T_*(-8.851848247132083535e-15 + T_*(4.677283798958746060e-16 + T_*(-3.377724777720887866e-19 + T_*(-6.778431209929119910e-19 + T_*(1.909999269223526139e-20 + T_*(9.427260272358086902e-23 + T_*(-1.633059161478316526e-23 + T_*(2.708622795104127005e-25 + T_*(6.445543879491312650e-27 + T_*(-2.078718471336905406e-28 + T_*(-2.016493649653205313e-30 + T_*(7.291705229467798305e-32 + T_*(6.973885505962506106e-34 + T_*(-1.243153175451631259e-35 + T_*(-1.747602826852742282e-37 + T_*(4.025138748049462320e-40 + T_*(1.779605454087125514e-41 + T_*(1.089101654848376309e-43 + T_*(2.193965048650129779e-46)))))))))))))))))))) + Tref*(3.969648581467453477e-14 + T_*(4.275832846661254448e-17 + T_*(-1.630434800196376049e-16 + T_*(1.006846934688499669e-17 + T_*(-5.738371188727877921e-20 + T_*(-1.265344904203675984e-20 + T_*(3.951946577446354041e-22 + T_*(1.118415999065847129e-24 + T_*(-3.047246007204336205e-25 + T_*(5.037294696928604711e-27 + T_*(1.113448299527111101e-28 + T_*(-3.604420125095418264e-30 + T_*(-3.231285840716890340e-32 + T_*(1.227607004749029241e-33 + T_*(1.092736874549671957e-35 + T_*(-2.080389533748509860e-37 + T_*(-2.765783939073700340e-39 + T_*(7.366082359558687899e-42 + T_*(2.849525456795798343e-43 + T_*(1.700715454376040795e-45 + T_*(3.363264203021455514e-48)))))))))))))))))))) + Tref*(2.927137085046097288e-16 + T_*(-3.935009649780155178e-18 + T_*(-1.284655068689595709e-18 + T_*(8.891518291215523007e-20 + T_*(-8.097307188437127417e-22 + T_*(-1.002482072705951799e-22 + T_*(3.412557036570838544e-24 + T_*(4.353599102910644877e-27 + T_*(-2.453868397103998903e-27 + T_*(4.077210937518472898e-29 + T_*(8.540429301713424698e-31 + T_*(-2.761396120627240847e-32 + T_*(-2.360949158806488756e-34 + T_*(9.183260327840185531e-36 + T_*(7.826940211721965909e-38 + T_*(-1.544903696997841248e-39 + T_*(-1.985776407624953312e-41 + T_*(5.721953154384942159e-44 + T_*(2.056659634078368459e-45 + T_*(1.207761008725242118e-47 + T_*(2.358660719333300090e-50)))))))))))))))))))) + Tref*(8.850509254802305667e-19 + T_*(-2.460614410261965249e-20 + T_*(-3.666765933098910708e-21 + T_*(2.884766059238598741e-22 + T_*(-3.503553726804075308e-24 + T_*(-2.942256445453415999e-25 + T_*(1.091792912917949703e-26 + T_*(-8.729131699634505854e-31 + T_*(-7.417602703867984309e-30 + T_*(1.244456106034623020e-31 + T_*(2.490121868117401162e-33 + T_*(-8.025123339833595423e-35 + T_*(-6.641950671247870409e-37 + T_*(2.611092270584569463e-38 + T_*(2.159886882084760350e-40 + T_*(-4.356305040994891672e-42 + T_*(-5.468644645046851238e-44 + T_*(1.657602540238644850e-46 + T_*(5.674290806706572681e-48 + T_*(3.291630188958066454e-50 + T_*(6.365043665031751049e-53))))))))))))))))))))))))))))))  # noqa: E501

    # Return theta-w converted to K
    return thw + 273.15


@vectorize(nopython=True, cache=True)
def temp(p, thw):
    """
    Computes the temperature T at pressure p on a pseudoadiabat with
    wet-bulb potential temperature thw.

    Uses polynomial approximations from Moisseeva and Stull (2017) with
    revised coefficients.

    Moisseeva, N. and Stull, R., 2017. A noniterative approach to
        modelling moist thermodynamics. Atmospheric Chemistry and
        Physics, 17, 15037-15043.

    Args:
        p: pressure (Pa)
        thw: wet-bulb potential temperature (K)

    Returns:
        T: temperature (K)

    """

    # Convert p to hPa and theta-w to degC
    p_ = p / 100.
    thw_ = thw - 273.15

    # Check that values fall in the permitted range
    if (thw_ < -50.) or (thw_ > 50.) or (p_ > 1100.) or (p_ < 100.):
        # print('thw or p outside limits of polynomial fit', thw_, p_)
        return np.nan

    # Compute T using Eq. 1-3 from Moisseeva & Stull 2017
    thref = -1.859181731693125244e+02 + p_*(1.606118467970104158e+00 + p_*(-1.401541126852152812e-02 + p_*(1.118012095309975557e-04 + p_*(-6.930749009115201978e-07 + p_*(3.259190519648021862e-09 + p_*(-1.144775795729461149e-11 + p_*(2.929326356797450022e-14 + p_*(-5.235740712445811320e-17 + p_*(5.929643966548681312e-20 + p_*(-2.840710781483815055e-23 + p_*(-2.303633256914850854e-26 + p_*(4.057702171481502496e-29 + p_*(-4.414234290637441819e-33 + p_*(-3.273368062368199420e-35 + p_*(2.066208601254068115e-38 + p_*(1.761984576990226152e-41 + p_*(-3.323558173770510565e-44 + p_*(2.135538802351356377e-47 + p_*(-6.699425988975201701e-51 + p_*(8.621817352809861352e-55))))))))))))))))))))  # noqa: E501
    T = -2.893123709546398814e+01 + thw_*(1.337099717397613352e+00 + thw_*(9.893115107847811479e-03 + thw_*(-6.056941969845558422e-05 + thw_*(-8.117528948999574447e-06 + thw_*(-1.581196345512124458e-07 + thw_*(4.033523298817163325e-09 + thw_*(3.056646405145132662e-10 + thw_*(1.417469454108082756e-12 + thw_*(-3.306941270310646335e-13 + thw_*(-4.968367373704207207e-15 + thw_*(2.381218727733625594e-16 + thw_*(4.812605215616211165e-18 + thw_*(-1.141178565445043151e-19 + thw_*(-2.622979227694438131e-21 + thw_*(3.474029291351130439e-23 + thw_*(8.502490500602033732e-25 + thw_*(-6.053664438771600262e-27 + thw_*(-1.528492694625356143e-28 + thw_*(4.585019100904648169e-31 + thw_*(1.174528584885858642e-32)))))))))))))))))))) + thref*(1.428019378331603972e+00 + thw_*(-8.012252977888566219e-03 + thw_*(-6.778561188475912833e-04 + thw_*(-1.479770281301290173e-05 + thw_*(1.718786810353641890e-07 + thw_*(2.979844442616419188e-08 + thw_*(1.010932145540506782e-09 + thw_*(-2.526811380445618072e-11 + thw_*(-2.264609162358801220e-12 + thw_*(6.380941517512868717e-15 + thw_*(2.619790758527706864e-15 + thw_*(7.478276972525606482e-18 + thw_*(-1.901863504201468146e-18 + thw_*(-8.219338216113219139e-21 + thw_*(8.897088310001328375e-22 + thw_*(3.619525377288825218e-24 + thw_*(-2.602499919814280992e-25 + thw_*(-7.847750209971533263e-28 + thw_*(4.328913906728013440e-29 + thw_*(6.873883059588235847e-32 + thw_*(-3.124371729816913149e-33)))))))))))))))))))) + thref*(4.902087477407687452e-03 + thw_*(-5.396055087421055933e-04 + thw_*(-8.575240566434924795e-06 + thw_*(7.933982762628838654e-07 + thw_*(5.323592879689340560e-08 + thw_*(4.615889977958287242e-10 + thw_*(-1.096693011928721248e-10 + thw_*(-3.738383671131761528e-12 + thw_*(1.215767246058940286e-13 + thw_*(6.545133019788350361e-15 + thw_*(-7.580370879281589839e-17 + thw_*(-6.170688671900019706e-18 + thw_*(2.172427296249444801e-20 + thw_*(3.493323555458182245e-21 + thw_*(2.259312781939176237e-24 + thw_*(-1.185828833982949812e-24 + thw_*(-3.694810611780279935e-27 + thw_*(2.226004806490829282e-28 + thw_*(1.046720989844058879e-30 + thw_*(-1.777339022447717813e-32 + thw_*(-1.027214202551836552e-34)))))))))))))))))))) + thref*(-1.694553174349895859e-04 + thw_*(-3.644801834316982502e-06 + thw_*(6.827201848456943116e-07 + thw_*(3.675781802425452264e-08 + thw_*(-4.368802681764397387e-11 + thw_*(-1.228734415114308065e-10 + thw_*(-4.928182328227474814e-12 + thw_*(2.043022862162354607e-13 + thw_*(1.367080176289978098e-14 + thw_*(-1.953971706355257430e-16 + thw_*(-1.886641069814541838e-17 + thw_*(1.116439054100195584e-19 + thw_*(1.555579978310694384e-20 + thw_*(-3.693346745679753864e-23 + thw_*(-7.982707623077428312e-24 + thw_*(6.114790597061083492e-27 + thw_*(2.501835420292277007e-27 + thw_*(-2.249211008667959989e-31 + thw_*(-4.387512623302412291e-31 + thw_*(-4.060424984927617865e-35 + thw_*(3.301234046472188660e-35)))))))))))))))))))) + thref*(-3.085688978839906849e-06 + thw_*(3.346538971403825261e-07 + thw_*(2.323460761163376915e-08 + thw_*(-7.434159290255723135e-10 + thw_*(-1.213868452986420457e-10 + thw_*(-1.516622793936740922e-12 + thw_*(3.157336506948498347e-13 + thw_*(9.054384551438845399e-15 + thw_*(-4.683864049875227457e-16 + thw_*(-1.697716200015498280e-17 + thw_*(4.258662256263146186e-19 + thw_*(1.710689601585043488e-20 + thw_*(-2.429898847419916344e-22 + thw_*(-1.019971736909017042e-23 + thw_*(8.567711569233276972e-26 + thw_*(3.601779564488583437e-27 + thw_*(-1.748650915404449789e-29 + thw_*(-6.969298718091599973e-31 + thw_*(1.743357195456333599e-33 + thw_*(5.697788380522173303e-35 + thw_*(-4.824192632310468290e-38)))))))))))))))))))) + thref*(3.902862970953406491e-08 + thw_*(7.976366036341323872e-09 + thw_*(-7.649068717037917429e-11 + thw_*(-5.055170417712468606e-11 + thw_*(-2.251248536993657310e-12 + thw_*(1.488076905197077979e-13 + thw_*(1.226253311603830693e-14 + thw_*(-2.303155363378381121e-16 + thw_*(-2.898126094602878134e-17 + thw_*(1.944167306796942071e-19 + thw_*(3.879101313700697830e-20 + thw_*(-8.155566850769751600e-23 + thw_*(-3.190182020980285741e-23 + thw_*(5.945042923877172880e-27 + thw_*(1.644658014796866682e-26 + thw_*(8.590908746170303202e-30 + thw_*(-5.185408782150655902e-30 + thw_*(-3.234883931489388039e-33 + thw_*(9.144790213816948145e-34 + thw_*(3.665546562314607918e-37 + thw_*(-6.913352257573384459e-38)))))))))))))))))))) + thref*(1.652698315273956771e-09 + thw_*(-5.291009014215654102e-11 + thw_*(-1.766244257592236039e-11 + thw_*(-2.182400142647046340e-13 + thw_*(7.297792600078693263e-14 + thw_*(2.998816890060157993e-15 + thw_*(-1.473316494649148281e-16 + thw_*(-9.843486757732904516e-18 + thw_*(1.457696150985512484e-19 + thw_*(1.616770727965644293e-20 + thw_*(-4.250677452853297834e-23 + thw_*(-1.543185565135706611e-23 + thw_*(-5.076310181380459982e-26 + thw_*(8.939370778568745252e-27 + thw_*(5.941817272691540765e-29 + thw_*(-3.099947285098207455e-30 + thw_*(-2.707899011069586038e-32 + thw_*(5.921823379288058993e-34 + thw_*(5.991070800021446860e-36 + thw_*(-4.794033581053480218e-38 + thw_*(-5.307977346670338633e-40)))))))))))))))))))) + thref*(1.810714912863214113e-11 + thw_*(-4.420940659565457951e-12 + thw_*(-4.010429157673513943e-13 + thw_*(2.248242764659458450e-14 + thw_*(3.118993858073355859e-15 + thw_*(-3.285866201558242102e-17 + thw_*(-1.143954697654892178e-17 + thw_*(-2.591712223135955497e-20 + thw_*(2.337323119143169102e-20 + thw_*(1.408287815433076374e-22 + thw_*(-2.901628028296679182e-23 + thw_*(-1.923220178655577362e-25 + thw_*(2.277147823675599052e-26 + thw_*(1.354288000221521945e-28 + thw_*(-1.135962443450874460e-29 + thw_*(-5.342150414989236196e-32 + thw_*(3.492553794386633833e-33 + thw_*(1.120768673165228360e-35 + thw_*(-6.034742041687945678e-37 + thw_*(-9.753052804339257811e-40 + thw_*(4.483885848170758124e-41)))))))))))))))))))) + thref*(5.963852005898371070e-14 + thw_*(-6.860501876737841612e-14 + thw_*(-4.211051092412291943e-15 + thw_*(4.669601015462160673e-16 + thw_*(4.396147910737770733e-17 + thw_*(-1.346199607551553489e-18 + thw_*(-1.863620978827359405e-19 + thw_*(2.030500627059942285e-21 + thw_*(4.184601983835599988e-22 + thw_*(-1.632609472110072782e-24 + thw_*(-5.571155159117743896e-25 + thw_*(5.725277352409762076e-28 + thw_*(4.620328648204041361e-28 + thw_*(7.517939191501621276e-32 + thw_*(-2.411611797922411317e-31 + thw_*(-1.357702696016684330e-34 + thw_*(7.702522079252904023e-35 + thw_*(4.308875666977018000e-38 + thw_*(-1.375140530008775840e-38 + thw_*(-4.661894912961247220e-42 + thw_*(1.051272212590398658e-42)))))))))))))))))))) + thref*(-2.465189770244733122e-16 + thw_*(-4.625151543823851723e-16 + thw_*(-2.168460898346131811e-17 + thw_*(3.621993725925196260e-18 + thw_*(2.795606743691950283e-19 + thw_*(-1.256475808963347927e-20 + thw_*(-1.284250377315071140e-21 + thw_*(2.427485099675600005e-23 + thw_*(3.026296454004628596e-24 + thw_*(-2.826342626266552960e-26 + thw_*(-4.170451069190766786e-27 + thw_*(2.046908754013633493e-29 + thw_*(3.552014636381298257e-30 + thw_*(-9.220069876075778882e-33 + thw_*(-1.894176278256675700e-33 + thw_*(2.490926939333630304e-36 + thw_*(6.158148104041475885e-37 + thw_*(-3.653102382713077079e-40 + thw_*(-1.116004956184535204e-40 + thw_*(2.197307286150311082e-44 + thw_*(8.641845899247070131e-45)))))))))))))))))))) + thref*(-1.595070109073189173e-18 + thw_*(-1.188312508648694955e-18 + thw_*(-4.400210495458582437e-20 + thw_*(1.015527136663282533e-20 + thw_*(6.795146223617114963e-22 + thw_*(-3.873084721345509005e-23 + thw_*(-3.299691050334559047e-24 + thw_*(8.255719801427078644e-26 + thw_*(8.026204285338997140e-27 + thw_*(-1.064758381047134529e-28 + thw_*(-1.131158232337426592e-29 + thw_*(8.599440057208646555e-32 + thw_*(9.802673196411120293e-33 + thw_*(-4.367063056643114431e-35 + thw_*(-5.301229761172261942e-36 + thw_*(1.352587263546924618e-38 + thw_*(1.743657830218456043e-39 + thw_*(-2.332255975000836191e-42 + thw_*(-3.191205893815347262e-43 + thw_*(1.714982390880737606e-46 + thw_*(2.492108182781206235e-47))))))))))))))))))))))))))))))  # noqa: E501

    # Return T converted to K
    return T + 273.15
